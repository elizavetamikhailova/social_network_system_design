# System Design социальной сети для путешественников для курса по System Design https://balun.courses
## ФТ:
- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия;
- оценка и комментарии постов других путешественников;
- подписка на других путешественников, чтобы следить за их активностью;
- поиск популярных мест для путешествий и просмотр постов с этих мест;
- просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке;
## НФТ:
- DAU 10 000 000 в первый год, рост линейный (после года тоже ожидается рост)
- Avg requests per day: создание постов - 2/неделя, загрузка фото к посту 5 фото/день, реакции (комментарий + оценка) - 10/день, подписка - 1-3 новые подписки/день, поиск - 7 поисков/день, просмотр полной информации в посте - 21 пост/день, загрузка ленты 30 загрузок/день (включая пагинацию)
- Аудитория приложения - страны СНГ (планов выходить на зарубежный рынок пока нет)
- Сезонность: в сезоны отпусков люди будут создавать больше постов, а в преддверии сезона отпусков и сразу после чаще заходить на платформу, предположительно в 2 раза чаще
- Хранение данных: всегда
- Лимиты и ограничения: 100 постов в день, в каждом посте не более 5 фото. В комментариях не более 1000 символов
- Временные ограничения: загрузка поста - не более 2 сек, поиск - не более 3 сек, реакции и подписка - 1 сек, загрузка полной информации о посте - 2 сек
- Доступность 99,99%
## Рассчет нагрузки:
### Создание постов
> Post
> 
>> - id 8 byte
>> - user_id 8 byte
>> - photo_urls (~200 byte на ссылку, 5 * 200) 1000 byte 
>> - description 1000 byte
>> - latitude 8 byte
>> - longtitude 8 byte
- RPS(пост) = dau * avg_requests_per_day_by_user / 86 400 = 10 000 000 * 0.3 / 86 400 = 35
- Traffic(пост) = rps * avg_request_size = 35 * 2 kb = 70 kb
- RPS(фото) = dau * avg_requests_per_day_by_user / 86 400 = 10 000 000 * 1.7 / 86 400 = 196
- Traffic(загрузка фото) = 196 * 3000 kb(примерный вес фото из поста после сжатия) = 574 mb
- Connections = dau * 0.1 = 1 000 000
### Реакции (оставить реакцию)
> Reaction
>
>> - id 8 byte
>> - post_id 8 byte
>> - user_id 8 byte
>> - rate 8 byte
>> - comment 1000 byte
- RPS = 10 000 000 * 10 / 86 400 = 1157
- Traffic = 1157 * 1 kb = 1 mb
- Connections = dau * 0.1 = 1 000 000
### Комментарий (оставить комментарий)
> Comment
>
>> - id 8 byte
>> - post_id 8 byte
>> - user_id 8 byte
>> - comment_id 8 byte
>> - comment 1000 byte
- RPS = 10 000 000 * 10 / 86 400 = 1157
- Traffic = 1157 * 1 kb = 1 mb
- Connections = dau * 0.1 = 1 000 000
## Подписки (подписаться на кого-то)
> Subscription
>
>> id 8 byte
>> user_id 8 byte
>> subscription_to_id 8 byte
- RPS = 10 000 000 * 3 / 86 400 = 347
- Traffic = 347 * 24 = 8 kb
- Connections = dau * 0.1 = 1 000 000
### Поиск
> Search
>
>> location_user_input 50 byte
>> latitude 8 byte
>> longitude 8 byte
- RPS = 10 000 000 * 7 / 86 400 = 810
- Traffic (in) = 810 * 66 = 52 kb
> Search result
>
>> List < Post > - если во время загрузки фото будет применяться какой-то алгоритм сжатия, то можно предложить что одно фото будет весить ~400 kb, тогда 400 × 5 фото/пост + описание и тд ~1032 byte = ~ 2 mb на пост и предположим, что у нас пагинация и за раз загружаем 10 постов, тогда, получается 20 mb
- Traffic (out) = 810 * 20 mb = 15 GB
- Connections = dau * 0.1 = 1 000 000
### Просмотр поста
> Post
> 
>> - id 8 byte
>> - user_id 8 byte
>> - photo_urls (~200 byte на ссылку, 5 * 200) 1000 byte 
>> - description 1000 byte
>> - latitude 8 byte
>> - longtitude 8 byte
>> - List < Reaction > - тут тоже должна быть какая-то пагинация, допустим, что на старте 10 реакций загружаем – 10 kb
>> - rate 8 byte
- RPS(загрузка информации о посте) = 10 000 000 * 21 / 86 400 = 2430
- Traffic(загрузка информации о посте) = 2430 * 11 kb = 27 mb
- RPS(загрузка фото) = 10 000 000 * 21 * 5 / 86 400 = 12 152
- Traffic(загрузка фото) = 12 152 * 5 * 400 kb = 23 gb
- Connections = dau * 0.1 = 1 000 000   
### Просмотр ленты
> Posts
>
>> List < Post > - если во время загрузки фото будет применяться какой-то алгоритм сжатия, то можно предложить что одно фото будет весить ~400 kb, тогда 400 × 5 фото/пост + описание и тд ~1032 byte = ~ 2 mb на пост и предположим, что у нас пагинация и за раз загружаем 10 постов, тогда, получается 20 mb
- RPS = 10 000 000 * 30 / 86 400 = 3472
- Traffic (out) = 3472 * 20 mb = 67 GB
- Connections = dau * 0.1 = 1 000 000
